/*! com_bixmailing 01-02-2015 19:03:21 */
(function(i){"use strict";var t;jQuery&&UIkit&&(t=i(jQuery,UIkit)),"function"==typeof define&&define.amd&&define("uikit-bixuserform",["uikit"],function(){return t||i(jQuery,UIkit)})})(function(i,t){"use strict";function e(e){var s=this;this.ajaxReq=!1,this.spinFields=e.find("[name*=address1], [name*=city]"),this.spinFields.each(function(){var t=i(this);t.wrap(i("<div></div>").css("position","relative").width(t.outerWidth())),t.after(i('<i class="uk-icon-spinner uk-icon-spin"></i>').css({position:"absolute",right:"10px",top:"10px"}).hide())}),e.find("[name*=postal_code], [name*=address2]").keyup(function(){var i,t,a={},n="",o=e.find("[name*=postal_code]").val().replace(/\s+/,"").toUpperCase(),r=e.find("[name*=address2]").val();6!==o.length&&(o=!1),r.match(/\-/)&&(i=r.split("-"),r=i[0],n=i[1]),t=r.toInt(),o&&t&&(a.pcode=o,a.huisnr=t,a.toev=n,s.lookup(a))}),this.lookup=function(s){var n=this;this.ajaxReq!==!1?this.ajaxReq.abort():this.spin(),t.notify.closeAll(),this.ajaxReq=i.ajax({type:"POST",dataType:"json",url:a,data:s}).done(function(i){i.success&&i.result.street&&(e.find("[name*=address1]").val(i.result.street),e.find("[name*=city]").val(i.result.city),e.find("[name*=postal_code]").val(i.result.postcode)),n.stopSpin()}).always(function(i){n.ajaxReq=!1,i.messages&&t.bixTools.showNotifications(i.messages)})},this.spin=function(){this.spinFields.each(function(){i(this).next().show()})},this.stopSpin=function(){this.spinFields.each(function(){i(this).next().hide()})}}var a="/index.php?option=com_bixmailing&format=raw&task=bixmailing.postcodecheck",s="bix-userform",n="/index.php?option=com_bixmailing&view=klant&layout=confirm&format=raw";return t.component("bixuserform",{defaults:{},boot:function(){t.ready(function(e){i("[data-bix-userform]",e).each(function(){var e=i(this);e.data("bixuserform")||t.bixuserform(e,t.Utils.options(e.attr("data-bix-userform")))}),i("[data-bix-ajax-submit]",e).each(function(){var e=i(this),a=t.bixajaxsubmit(e,t.Utils.options(e.attr("data-bix-ajax-submit")));!e.attr("data-checkset")&&a&&e.attr("id")===s&&(a.validateForm=function(){return document.formvalidator.isValid(e.get(0))},a.onSuccess=function(i){i.confirm&&e.load(n+"&id="+i.id),t.bixTools.scrollToEl(e,{offset:100})},e.attr("data-checkset",!0))})})},init:function(){var t=this,a=this.find('[name="jform[name]"]').prop("readonly",!0).addClass("readonly"),s=this.find('[name="jform[profile][voornaam]"]').change(function(){t.setNaam(a,s,n)}),n=this.find('[name="jform[profile][achternaam]"]').change(function(){t.setNaam(a,s,n)});this.fieldsets=this.find("fieldset"),this.element.prepend(this.fieldsets.get(1)),this.find("[name*=postal_code]").closest("fieldset").each(function(){new e(i(this))})},setNaam:function(i,t,e){var a=t.val()?t.val()+" ":"";i.val(a+e.val())}}),t.bixuserform});